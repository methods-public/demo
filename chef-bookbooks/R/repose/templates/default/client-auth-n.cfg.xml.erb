<?xml version="1.0" encoding="UTF-8"?>

<!-- Automatically generated by Chef, do not modify -->
<% if !@version.nil? && @version.split('.')[0].to_i < 7 %>
<client-auth xmlns="http://docs.rackspacecloud.com/repose/client-auth/v1.0">
<% else %>
<client-auth xmlns="http://docs.openrepose.org/repose/client-auth/v1.0">
<% end %>
    <% if @auth_provider == 'RACKSPACE' %>
<% if !@version.nil? && @version.split('.')[0].to_i >6 %>
        <delegating quality="<%= @delegating_quality %>" /> 
<% end %>
    <rackspace-auth 
<% if !@version.nil? && @version.split('.')[0].to_i < 7 %>
        delegable="<%= @delegable %>" 
<% end %>
        request-groups="<%= @request_groups %>" xmlns="http://docs.rackspacecloud.com/repose/client-auth/rs-auth-1.1/v1.0">
        <authentication-server username="<%= @username %>" password="<%= @password %>" uri="<%= @auth_uri %>" />
        <% if @mapping_regex %>
        <account-mapping id-regex="<%= @mapping_regex %>" type="<%= @mapping_type %>"/>
        <% end %>
    </rackspace-auth>

    <% elsif @auth_provider == 'OPENSTACK' %>

    <openstack-auth 
<% if !@version.nil? && @version.split('.')[0].to_i < 7 %>
        delegable="<%= @delegable %>" 
<% end %>
        tenanted="<%= @tenanted %>" request-groups="<%= @request_groups %>" token-cache-timeout="<%= @token_cache_timeout %>" group-cache-timeout="<%= @group_cache_timeout %>" xmlns="http://docs.openrepose.org/repose/client-auth/os-ids-auth/v1.0">
        <identity-service username="<%= @username %>" password="<%= @password %>" tenantId="<%= @tenant_id %>" uri="<%= @auth_uri %>" />
        <% if @tenanted %>
        <% for @mapping in @mapping_regex %>
        <client-mapping id-regex="<%= @mapping %>"/>
        <% end %>
        <% unless @service_admin_roles.empty? %>
        <service-admin-roles>
        <% for @role in @service_admin_roles %>
            <role><%= @role %></role>
        <% end %>
        </service-admin-roles>
        <% end %>
        <% unless @ignore_tenant_roles.empty? %>
        <ignore-tenant-roles>
        <% for @role in @ignore_tenant_roles %>
            <role><%= @role %></role>
        <% end %>
        </ignore-tenant-roles>
        <% end %>
        <% end %>
        <% if @endpoints_in_header %>
        <endpoints-in-header format="XML" cache-timeout="600000" identity-contract-version="2"/>
        <% end %>
    </openstack-auth>

    <% end %>

    <% if @white_list %>
    <white-list>
        <uri-pattern uri-regex="<%= @uri_regex %>" />
    </white-list>
    <% end %>

</client-auth>
