{
  "name": "filebeat",
  "description": "Installs/Configures Elastic Filebeat",
  "long_description": "filebeat Cookbook\n================\n\n[![Cookbook](https://img.shields.io/github/tag/vkhatri/chef-filebeat.svg)](https://github.com/vkhatri/chef-filebeat) [![Build Status](https://travis-ci.org/vkhatri/chef-filebeat.svg?branch=master)](https://travis-ci.org/vkhatri/chef-filebeat)\n\nThis is a [Chef] cookbook to manage [Filebeat].\n\n\n>> For Production environment, always prefer the [most recent release](https://supermarket.chef.io/cookbooks/filebeat).\n\n\n## Most Recent Release\n\n```ruby\ncookbook 'filebeat', '~> 1.5.0'\n```\n\n\n## From Git\n\n```ruby\ncookbook 'filebeat', github: 'vkhatri/chef-filebeat',  tag: 'v1.5.0'\n```\n\n\n## Repository\n\n```\nhttps://github.com/vkhatri/chef-filebeat\n```\n\n\n## Supported OS\n\n- Windows\n- Amazon Linux\n- CentOS\n- Fedora\n- Ubuntu\n- Debian\n- Mac OSX\n\nAlso works on Solaris zones given a physical Solaris 11.2 server. For that, use the .kitchen.zone.yml file. Check usage at (https://github.com/criticalmass/kitchen-zone). You will need an url to a filebeat package that works on Solaris 11.2. Checkout Building-Filebeat-On-Solaris11.md for instructions to build a filebeat package.\n\n\n## Supported Chef\n\n- Chef 12 (last tested on 12.21.4)\n\n- Chef 13 (last tested on 13.3.42)\n\n\n## Supported Filebeat\n\n- 1.x (dropped test support in cookbook version v1.0.0)\n- 5.x\n- 6.x\n\n\n## Major Changes\n\nRefer CHANGELOG.md.\n\n\n## Cookbook Dependency\n\n- windows\n- elastic_beats_repo\n- yum-plugin-versionlock\n- runit\n\n\n## Recipes\n\n- `filebeat::attributes` - cookbook derived default attributes\n\n- `filebeat::config` - configure filebeat\n\n- `filebeat::default` - default recipe (use it for run_list)\n\n- `filebeat::install_mac_os_x` - install filebeat for mac osx platform\n\n- `filebeat::install_package` - install filebeat package for linux platform\n\n- `filebeat::install_package_preview` - install filebeat preview (alpha/beta) package for linux platform\n\n- `filebeat::install_solaris` - install filebeat package for solaris platform\n\n- `filebeat::install_windows` - install filebeat for windows platform\n\n- `filebeat::prospectors` - configure filebeat prospectors via node attribute `node['filebeat']['prospectors']`\n\n- `filebeat::service` - configure filebeat service\n\n## Limitations\n\nThe Mac OSX setup only allows for package installs and depends on brew, this means that version selection and preview build installs are not supported.\n\n## LWRP filebeat_prospector\n\nLWRP `filebeat_prospector` creates filebeat prospector configuration yaml file under directory `node['filebeat']['prospectors_dir']` with file name `lwrp-prospector-#{resource_name}.yml`.\n\n\n**LWRP example**\n\n```ruby\nfilebeat_prospector 'messages' do\n  paths ['/var/log/messages']\n  document_type 'apache'\n  ignore_older '24h'\n  scan_frequency '15s'\n  harvester_buffer_size 16384\n  fields 'type' => 'apacheLogs'\nend\n```\n\n**LWRP Options**\n\n- *action* (optional)\t- default :create, options: :create, :delete\n- *type* (optional, String) - filebeat prospector configuration attribute\n- *sensitive* (optional, Boolean) - default true, chef resource attribute sensitive\n- *input_type* (optional, String) - filebeat prospector configuration attribute\n- *paths* (optional, String)\t- filebeat prospector configuration attribute\n- *recursive_glob_enabled* (optional, TrueClass/FalseClass) - filebeat prospector configuration attribute\n- *encoding* (optional, String)\t- filebeat prospector configuration attribute\n- *exclude_lines* (optional, Array) - A list of regular expressions to match the lines that you want filebeat to exclude. Filebeat drops any lines that match a regular expression in the list. By default, no lines are dropped.\n- *include_lines* (optional, Array) - A list of regular expressions to match the lines that you want filebeat to include. Filebeat exports only the lines that match a regular expression in the list. By default, all lines are exported.\n- *exclude_files* (optional, Array) - A list of regular expressions to match the files that you want filebeat prospector instance to exclude.\n- *tags* (optional, Array)   - filebeat prospector configuration attribute\n- *fields* (optional, Hash)\t- filebeat prospector configuration attribute\n- *fields_under_root* (optional, TrueClass/FalseClass)\t- filebeat prospector configuration attribute\n- *ignore_older* (optional, String)\t- filebeat prospector configuration attribute\n- *close_inactive* (optional, String)  - filebeat prospector configuration attribute\n- *close_renamed* (optional, String)  - filebeat prospector configuration attribute\n- *close_eof* (optional, String)  - filebeat prospector configuration attribute\n- *close_timeout* (optional, String)  - filebeat prospector configuration attribute\n- *clean_inactive* (optional, String)  - filebeat prospector configuration attribute\n- *clean_removed* (optional, String)  - filebeat prospector configuration attribute\n- *scan_frequency* (optional, String) - filebeat prospector configuration attribute\n- *scan_sort* (optional, String) - filebeat prospector configuration attribute `scan.sort`\n- *scan_order* (optional, String) - filebeat prospector configuration attribute `sort.order`\n- *document_type* (optional, String)\t- filebeat prospector configuration attribute\n- *harvester_buffer_size* (optional, Integer)\t- filebeat prospector configuration attribute\n- *max_bytes* (optional, Integer) - filebeat prospector configuration attribute\n- *json_keys_under_root* (optional, String) - filebeat prospector configuration attribute `json.keys_under_root`\n- *json_overwrite_keys* (optional, String)  - filebeat prospector configuration attribute `json.overwrite_keys`\n- *json_add_error_key* (optional, String) - filebeat prospector configuration attribute `json.add_error_key`\n- *json_message_key* (optional, String) - filebeat prospector configuration attribute `json.message_key`\n- *multiline_pattern* (optional, String) - filebeat prospector configuration attribute `multiline.pattern`\n- *multiline_negate* (optional, String) - filebeat prospector configuration attribute `multiline.negate`\n- *multiline_match* (optional, String) - filebeat prospector configuration attribute `multiline.match`\n- *multiline_flush_pattern* (optional, String) - filebeat prospector configuration attribute `multiline.flush_pattern`\n- *multiline_max_lines* (optional, String) - filebeat prospector configuration attribute `multiline.max_lines`\n- *multiline_timeout* (optional, String) - filebeat prospector configuration attribute `multiline.timeout`\n- *tail_files* (optional, TrueClass/FalseClass)\t- filebeat prospector configuration attribute\n- *pipeline* (optional, String)\t- filebeat prospector configuration attribute\n- *symlinks* (optional, String)\t- filebeat prospector configuration attribute\n- *backoff* (optional, String)\t- filebeat prospector configuration attribute\n- *max_backoff* (optional, String)\t- filebeat prospector configuration attribute\n- *backoff_factor* (optional, Integer)\t- filebeat prospector configuration attribute\n- *harvester_limit* (optional, Integer)\t- filebeat prospector configuration attribute\n- *enabled* (optional, TrueClass/FalseClass) - filebeat prospector configuration attribute\n- *close_older* (optional, String)  - filebeat prospector configuration attribute\n- *force_close_files* (optional, TrueClass/FalseClass)\t- filebeat prospector configuration attribute\n- *multiline* (optional, Hash)\t- Multiline configuration hash. Options: `pattern`: <regex pattern to match>, `negate`: [true/false], `match`: [before/after]\n\n\n## How to Add Filebeat Output Configuration via Node Attribute\n\nFilebeat output configuration can be added to attribute `node['filebeat']['config']`.\n\n```json\n  \"default_attributes\": {\n    \"filebeat\": {\n      \"config\": {\n        \"output.elasticsearch\": {\n          \"enable\": true,\n          \"hosts\": \"127.0.0.1:9200\"\n        },\n        \"output.redis\": {\n          \"enable\": true,\n          \"option ..\": \"value ..\"\n        },\n        \"{output.redis|output.elasticsearch|output.kafka|output.file|output.console|output.logstash| ..}\": {\n          \"option ..\": \"value ..\",\n        }\n      }\n    }\n  }\n\n```\n\nAbove filebeat output configuration will be added to `filebeat.yml` file.\n\n\n## How to Add Filebeat Prospectors via Node Attribute\n\nIndividual prospector configuration file can also be added using attribute `default['filebeat']['prospectors']`. Each prospector configuration will be created using LWRP.\nFor more prospector options, check out LWRP `filebeat_prospector`\n\n```json\n  \"default_attributes\": {\n    \"filebeat\": {\n      \"prospectors\": {\n\n        \"system_logs\": {\n          \"paths\": [\n            \"/var/log/messages\",\n            \"/var/log/syslog\"\n          ],\n          \"type\": \"log\",\n          \"fields\": {\n            \"type\": \"system_logs\"\n          },\n          \"option ...\": \"value ...\"\n        },\n\n        \"apache_logs\": {\n          \"paths\": [\n            \"/var/log/apache/*.log\"\n          ],\n          \"type\": \"log\",\n          \"ignore_older\": \"24h\",\n          \"scan_frequency\": \"15s\",\n          \"harvester_buffer_size\": 16384,\n          \"fields\": {\n            \"type\": \"apache_logs\"\n          },\n          \"option ...\": \"value ...\"\n        },\n\n        \"prospector ...\": {\n          \"option ...\": \"value ...\"\n        }\n\n      }\n    }\n  }\n\n```\n\nAbove configuration will create three different prospector files - `lwrp-prospector-system_logs.yml, lwrp-prospector-secure_logs.yml and lwrp-prospector-apache_logs.yml` under `node['filebeat']['prospectors_dir']`.\n\n\n## Core Attributes\n\n* `default['filebeat']['version']` (default: `6.0.1`): filebeat version\n\n* `default['filebeat']['ignore_version']` (default: `false`): ignore filebeat version for `package` install\n\n* `default['filebeat']['setup_repo']` (default: `true`): setup `apt` or `yum` repository if set to `true`\n\n* `default['filebeat']['release']` (default: `1`): filebeat release for yum package\n\n* `default['filebeat']['service']['init_style']` (default: `init`): filebeat service init system, options: init, runit\n\n* `default['filebeat']['package_url']` (default: `auto`): package url for windows installation\n\n* `default['filebeat']['log_dir']` (default: `/var/log/filebeat`): filebeat logging directory\n\n* `default['filebeat']['conf_dir']` (default: `/etc/filebeat`): filebeat yaml configuration file directory\n\n* `default['filebeat']['conf_file']` (default: `/etc/filebeat/filebeat.yml`): filebeat configuration file\n\n* `default['filebeat']['notify_restart']` (default: `true`): whether to restart filebeat service on configuration file change\n\n* `default['filebeat']['disable_service']` (default: `false`): whether to stop and disable filebeat service\n\n* `default['filebeat']['prospectors_dir']` (default: `/etc/filebeat/conf.d`): prospectors configuration file directory\n\n* `default['filebeat']['prospectors']` (default: `{}`): prospectors configuration via node attribute\n\n* `default['filebeat']['modules']` (default: `{}`): modules configuration via node attribute\n\n* `default['filebeat']['delete_prospectors_dir']` (default: `false`): delete and create prospectors configuration directory if set to true\n\n* `default['filebeat']['purge_prospectors_dir']` (default: `false`): purge files under prospectors configuration directory if set to true, except `node-prospector-*` (created by node attribute) and `lwrp-prospector-` (created by LWRP)\n\n\n## Configuration File filebeat.yml Attributes\n\n* `default['filebeat']['config']['filebeat.prospectors']` (default: `[]`): filebeat prospectors configuration\n\n* `default['filebeat']['config']['filebeat.modules']` (default: `[]`): filebeat prospectors configuration\n\n* `default['filebeat']['config']['filebeat.registry_file']` (default: `/var/lib/filebeat/registry`): filebeat services to capture packets\n\n* `default['filebeat']['config']['filebeat.config_dir']` (default: `node['filebeat']['prospectors_dir']`): filebeat prospectors configuration files folder\n\nFor more attribute info check `attributes/config.rb`.\n\n\n## Other Attributes\n\n* `default['filebeat']['service']['name']` (default: `filebeat`): filebeat service name\n\n* `default['filebeat']['service']['retries']` (default: `:0`): filebeat service resource attribute\n\n* `default['filebeat']['service']['retry_delay']` (default: `:2`): filebeat service resource attribute\n\n\n## Contributing\n\n1. Fork the repository on Github\n2. Create a named feature branch (like `add_component_x`)\n3. Write your change\n4. Write tests for your change (if applicable)\n5. Run the tests (`rake & rake knife`), ensuring they all pass\n6. Write new resource/attribute description to `README.md`\n7. Write description about changes to PR\n8. Submit a Pull Request using Github\n\n\n## Copyright & License\n\nAuthors:: Virender Khatri and [Contributors]\n\n<pre>\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n</pre>\n\n\n[Chef]: https://www.chef.io/\n[Filebeat]: https://www.elastic.co/products/beats/filebeat\n[Contributors]: https://github.com/vkhatri/chef-filebeat/graphs/contributors\n",
  "maintainer": "Virender Khatri",
  "maintainer_email": "vir.khatri@gmail.com",
  "license": "Apache-2.0",
  "platforms": {
    "windows": ">= 0.0.0",
    "debian": ">= 0.0.0",
    "ubuntu": ">= 0.0.0",
    "centos": ">= 0.0.0",
    "amazon": ">= 0.0.0",
    "redhat": ">= 0.0.0",
    "fedora": ">= 0.0.0"
  },
  "dependencies": {
    "homebrew": "~> 4.2",
    "elastic_beats_repo": ">= 1.2.0",
    "yum-plugin-versionlock": ">= 0.1.2",
    "runit": ">= 0.0.0",
    "windows": ">= 0.0.0"
  },
  "providing": {

  },
  "attributes": {

  },
  "recipes": {

  },
  "version": "1.5.0",
  "source_url": "https://github.com/vkhatri/chef-filebeat",
  "issues_url": "https://github.com/vkhatri/chef-filebeat/issues",
  "privacy": false,
  "chef_versions": [
    [
      ">= 12.1"
    ]
  ],
  "ohai_versions": [

  ],
  "gems": [

  ]
}
