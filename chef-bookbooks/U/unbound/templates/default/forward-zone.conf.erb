# Generated by Chef for <%= node['hostname'] %>
#
# Forward zones
# Create entries like below, to make all queries for 'example.com' and
# 'example.org' go to the given list of servers. These servers have to handle
# recursion to other nameservers. List zero or more nameservers by hostname
# or by ipaddress. Use an entry with name "." to forward all queries.
# forward-zone:
#   name: "example.com"
#   forward-addr: 192.0.2.68
#   forward-addr: 192.0.2.73@5355  # forward to port 5355.
# forward-zone:
#   name: "example.org"
#   forward-host: fwd.example.com
server:
<% @forward_zone.each do |dex,rrset| -%>
  <% rrset.each do |rr| -%>
    <% rr.each do |fqdn,frwd| -%>
  forward-zone:
    name: "<%= fqdn %>."
      <% if frwd =~ /\d+\.\d+\.\d+\.\d+/ %>
    forward-addr: "<%= frwd %>"
      <% else %>
    forward-host: "<%= frwd %>"
      <% end -%>
    <% end -%>
  <% end -%>
<% end -%>
