# Generated by Chef for <%= node.name %>
#
# Edits will be lost.

# /etc/nslcd.conf
# nslcd configuration file. See nslcd.conf(5)
# for details.

# The user and group nslcd should run as.
uid  nslcd
gid  <%= @gid %>

# The location at which the LDAP server(s) should be reachable.
uri  <%= @uri %>

# nslcd tries to reuse LDAP connection forever, 
# but requests start ending up with "unknown error" soon 
# Regular enforced re-connection solves this issue.
# Since the timer is reset each time a request comes in, 
# 60 seconds won't work here; put a small limit so
# it reconnects often.
idle_timelimit 1

# The search base that will be used for all queries.
base ou=user,host=<%= @host_id %>,account=<%= @account %>,o=conjur
base group ou=group,host=<%= @host_id %>,account=<%= @account %>,o=conjur

# The LDAP protocol version to use.
# ldap_version 3

# The DN to bind with for normal lookups.
binddn uid=<%= @host_id %>,ou=host,host=<%= @host_id %>,account=<%= @account %>,o=conjur
bindpw <%= @host_api_key %>

<% if @cacertfile %>
tls_cacertfile <%= @cacertfile %>
<% end %>
