# Generated by Chef - local changes will be overwritten

LogFormat myVScanFmt "%tl, %>a %is %Ib %Ob %huo [Action: %{virus_scan:action}Sa] [Virus: %{virus_scan:virus}Sa]"
acl VSCAN service virus_scan
AccessLog <%= node['c_icap']['log_dir'] %>/access-vscan.log myVScanFmt VSCAN

# Load the virus_scan service:
Service antivirus_module virus_scan.so

#Add an alias to srv_clamav for compatibility with old service name
ServiceAlias srv_clamav virus_scan

# Add the alias avscan for virus_scan service. It is used by many
# ICAP based antivirus clients:
ServiceAlias  avscan virus_scan?allow204=on

# Antivirus module settings
virus_scan.ScanFileTypes <%= node['c_icap']['virus_scan']['scan_file_types'].join(' ') %>
virus_scan.SendPercentData <%= node['c_icap']['virus_scan']['send_percent_data'] %>
virus_scan.StartSendPercentDataAfter <%= node['c_icap']['virus_scan']['start_send_percent_data_after'] %>
virus_scan.Allow204Responces <%= node['c_icap']['virus_scan']['allow_204_responces'] %>
virus_scan.PassOnError <%= node['c_icap']['virus_scan']['pass_on_error'] %>
virus_scan.MaxObjectSize  <%= node['c_icap']['virus_scan']['max_object_size'] %>
Include clamd_mod.conf
