<%# BAREOS TAPE AUTOLOADER DEFINITIONS TEMPLATE %>
# Generated by Chef for <%= node['bareos']['storage']['name'] %>
# Local modifications will be overwritten.
#
# Bareos Autochanger Definition File

## Default commented lines from packaged config

### Preparations


#### Include this configuration file in bareos-sd.conf by:

#@/etc/bareos/bareos-sd.d/device-tape-with-autoloader.conf


#### On Linux use "lsscsi --generic"
#### to get a list of your SCSI devices.
#### However, normaly you should access your devices by-id
#### (eg. /dev/tape/by-id/scsi-350011d00018a5f03-nst),
#### because the short device names like /dev/nst1
#### might change on reboot.

#DriveIndex = 0           #default:0, only required if the autoloader have multiple drives.


#### If only one drive is available, this is normally /dev/nst0.
#### However, it is advised to access it via id (/dev/tape/by-id/...)

#ArchiveDevice = /dev/nst0
#ArchiveDevice = /dev/tape/by-id/scsi-350011d00018a5f03-nst


#### Arbitrary string that descripes the the storage media.

#Description = "Some description for device"


#### Bareos uses this to determine which device can handle what media.

#MediaType = lto


#### Enable "Check Labels" if tapes with ANSI/IBM labels should be preserved

#Check Labels = yes
#AutoChanger = yes        # default: no
#AutomaticMount = y       # default: no
#MaximumFileSize = 10GB   # default: 1000000000 (1GB)


#########################################################

<%# AutoChanger Config %>
<% @autochangers.sort.each do |autochanger_key, line_value1| %>
Autochanger {
  Name = <%= autochanger_key %>
  Description = "<%= autochanger_key %> Defined by Chef"
  <% line_value1.each do |key1, value1| %>
    <% value1.each do |v1| %>
  <%= key1 %> = <%= v1 %>
    <% end %>
  <% end %>
}

<% end %>
<%# Device Config %>
<% @devices.sort.each do |device_key, line_value2| %>
Device {
  Name = <%= device_key %>
  Description = "<%= device_key %> Defined by Chef"
  <% line_value2.each do |key2, value2| %>
  <%= key2 %> = <%= value2 %>
  <% end %>
}

<% end %>
