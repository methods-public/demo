<%# STORAGE DAEMON TEMPLATE %>
# Generated by Chef for <%= node['bareos']['storage']['name'] %>
# Local modifications will be overwritten.
#
# Bareos Storage Daemon Configuration File

Storage {
  Name = <%= node['bareos']['storage']['name'] %>-sd
  SDPort = <%= node['bareos']['storage']['sd_port'] %>
  Maximum Concurrent Jobs = <%= node['bareos']['storage']['max_concurrent_jobs'] %>
}

<% @bareos_dir.each do |director| %>
# Director/Monitor Resources for <%= director['bareos']['director']['name'] %>
Director {
  Name = <%= director['bareos']['director']['name'] %>-dir
  Password = "<%= director['bareos']['sd_password'] %>"
}

Director {
  Name = <%= director['bareos']['director']['name'] %>-mon
  Password = "<%= director['bareos']['mon_password'] %>"
  Monitor = <%= director['bareos']['storage']['sd_mon_enable'] %>
}

Messages {
  Name = <%= node['bareos']['messages']['default_messages'] %>
  director = <%= director['bareos']['director']['name'] %>-dir = <%= node['bareos']['messages']['default_admin_messages'] %>
}
##########

<% end -%>

Device {  
  Name = FileStorage  
  Media Type = File  
  Archive Device = /var/lib/bareos/storage
  Random Access = Yes;  
  AutomaticMount = yes;  
  RemovableMedia = no;  
  AlwaysOpen = no;  
  LabelMedia = yes  
}

########################################
# Custom Storage Daemon Config Locations
########################################

@|"sh -c 'for conf in /etc/bareos/bareos-sd.d/*.conf ; do echo @${conf} ; done'"
